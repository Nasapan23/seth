// Seth - OpenClaw Configuration Template (Auto-Routing Edition)
// Copy to data/openclaw/openclaw.json and customize
// JSON5 format: comments and trailing commas allowed
//
// MODEL ROUTING STRATEGY:
// - FREE tier: Google Gemini for casual chat (zero cost with GOOGLE_AI_API_KEY)
// - CODING tier: Claude Sonnet for code tasks (auto-triggered)
// - SMART tier: Claude Sonnet for complex tasks (manual /model smart)
// - Sub-agents: CHEAP model (workers don't need to be smart)
// - Thinking: OFF by default (saves tokens)
// - Fallbacks: FREE OpenRouter models when rate-limited
//
// Documentation: https://docs.openclaw.ai/gateway/configuration

{
  // =========================================================================
  // Gateway Configuration
  // =========================================================================
  gateway: {
    mode: "local",
    bind: "lan",
    port: 18789,
    auth: {
      mode: "token",
    },
  },

  // =========================================================================
  // Provider Configuration (API Keys synced from environment)
  // =========================================================================
  // API keys are synced from environment variables by entrypoint.sh
  // Set these in .env file, not here:
  //   - OPENROUTER_API_KEY (access to all models via OpenRouter)
  //   - GOOGLE_AI_API_KEY (direct Gemini access, FREE tier)
  //   - ANTHROPIC_API_KEY (direct Anthropic access)
  //   - OPENAI_API_KEY (direct OpenAI access)
  env: {
    // Keys injected at runtime from environment
  },

  // =========================================================================
  // Model Routing Strategy
  // =========================================================================
  // OpenClaw 2026.2.1 does NOT support a top-level "routing" key
  // Instead, use one of these approaches:
  //
  // OPTION 1: OpenRouter Auto Model (Recommended for automatic routing)
  //   - Set model.primary to "openrouter/auto"
  //   - OpenRouter automatically selects the best model for each task
  //   - Powered by NotDiamond's routing engine
  //   - Handles complexity detection automatically
  //
  // OPTION 2: Manual Model Switching (Cost-optimized approach)
  //   - Set model.primary to a cheap model (e.g., claude-3-haiku)
  //   - Switch models mid-chat with /model commands:
  //     /model free    -> Google Gemini (zero cost)
  //     /model coding  -> Claude Sonnet (best for code)
  //     /model auto    -> OpenRouter Auto (intelligent routing)
  //     /model smart   -> Claude Sonnet (complex tasks)
  //     /model opus    -> Claude Opus (maximum power)
  //
  // OPTION 3: Specialized Sub-Agents
  //   - Create sub-agents with specific models for specific tasks
  //   - Main agent delegates to specialists (see agents.list below)
  //   - Example: researcher agent for web research, coder agent for coding
  //
  // The model aliases are defined in agents.defaults.models below

  // =========================================================================
  // Agent Configuration (Auto-Routing Enabled)
  // =========================================================================
  agents: {
    defaults: {
      workspace: "/home/seth/workspace",
      
      // PRIMARY: Cheap model for casual chat, greetings, simple Q&A
      // Switch to smart model with: /model smart
      model: {
        primary: "${SETH_MODEL}",  // openrouter/anthropic/claude-3-haiku
        fallbacks: [
          "openrouter/meta-llama/llama-3.3-70b-instruct:free",
          "openrouter/google/gemma-2-9b-it:free",
        ],
      },
      
      // MODEL ALIASES - switch with /model <alias>
      // Models available via OpenRouter: https://openrouter.ai/models
      // Direct Google Gemini: https://aistudio.google.com
      models: {
        // AUTOMATIC ROUTING - OpenRouter selects best model for each task
        "openrouter/auto": { alias: "auto" },
        
        // FREE tier - Google Gemini (direct API, $0 cost)
        // Requires GOOGLE_AI_API_KEY in environment
        "google/gemini-3-flash-preview": { alias: "free" },
        
        // CODING tier - best for code generation, debugging, refactoring
        "openrouter/anthropic/claude-sonnet-4": { 
          alias: "coding",
          // Cost: ~$3/1M input, $15/1M output
        },
        
        // Cheap models - ~$0.25/1M input, great for chat
        "openrouter/anthropic/claude-3-haiku": { alias: "cheap" },
        "openrouter/openai/gpt-4o-mini": { alias: "mini" },
        
        // Smart models (for complex reasoning) - ~$3/1M input
        "openrouter/anthropic/claude-sonnet-4": { alias: "smart" },
        "openrouter/openai/gpt-4o": { alias: "gpt" },
        
        // Maximum power (use sparingly!) - ~$15/1M input
        "openrouter/anthropic/claude-opus-4": { alias: "opus" },
        
        // Open source alternatives - many are FREE on OpenRouter
        "openrouter/meta-llama/llama-3.3-70b-instruct": { alias: "llama" },
        "openrouter/google/gemini-2.0-flash-001": { alias: "gemini" },
        "openrouter/qwen/qwen-2.5-coder-32b-instruct": { 
          alias: "qwen-coder",
          // Free coding-specialized model
        },
        
        // Future: local models via Ollama
        // "ollama/llama3.3": { alias: "local" },
      },
      
      // Sandbox: disabled inside container (already isolated)
      sandbox: {
        mode: "off",
      },
      
      // Sub-agents: use CHEAP model (workers don't need to be smart)
      subagents: {
        model: "${SETH_SUBAGENT_MODEL}",  // openrouter/anthropic/claude-3-haiku
        maxConcurrent: 4,
      },
      
      // THINKING: OFF by default to save tokens
      // Enable for complex tasks: /thinking high
      thinkingDefault: "off",
      
      // Timeout for agent runs (seconds)
      timeoutSeconds: 900,
    },
    
    // Agent definitions - extend for multi-agent "employee system"
    list: [
      {
        id: "main",
        default: true,
        identity: {
          name: "Seth",
          theme: "secure personal assistant and task manager",
          emoji: "ü§ñ",
        },
        subagents: {
          allowAgents: ["*"],
        },
      },
      // Specialized workers - delegates for specific tasks
      // Uncomment to enable sub-agents:
      //
      // RESEARCHER - Web research and information gathering
      // {
      //   id: "researcher",
      //   model: "openrouter/anthropic/claude-3-haiku",  // Cheap is fine
      //   identity: { name: "Researcher", emoji: "üîç" },
      //   tools: { allow: ["web_search", "web_fetch", "browser", "read"] },
      // },
      //
      // CODER - Code generation and debugging (uses best coding model)
      // {
      //   id: "coder",
      //   model: "openrouter/anthropic/claude-sonnet-4",  // Best for code
      //   identity: { name: "Coder", emoji: "üíª" },
      //   tools: { allow: ["read", "write", "exec", "shell"] },
      // },
      //
      // SUMMARIZER - Document processing and summarization
      // {
      //   id: "summarizer", 
      //   model: "openrouter/anthropic/claude-3-haiku",  // Cheap is fine
      //   identity: { name: "Summarizer", emoji: "üìù" },
      //   tools: { allow: ["read", "write"] },
      // },
    ],
  },

  // =========================================================================
  // Browser Configuration (Full Playwright Control)
  // =========================================================================
  browser: {
    enabled: true,
    defaultProfile: "openclaw",
    headless: true,
    noSandbox: true,  // Required inside Docker
    color: "#FF4500",
    // Snapshot defaults for efficiency
    snapshotDefaults: {
      mode: "efficient",
    },
    profiles: {
      openclaw: {
        cdpPort: 18800,
        color: "#FF4500",
      },
    },
  },

  // =========================================================================
  // Skills Configuration
  // =========================================================================
  skills: {
    load: {
      extraDirs: ["/opt/seth/skills"],
      watch: true,
    },
  },

  // =========================================================================
  // Tool Configuration (Full Power - Container Isolated)
  // =========================================================================
  tools: {
    // All tools enabled by default - container provides isolation
    // Use deny list only for tools you explicitly want to block
    deny: [
      "canvas",  // No UI canvas in headless Docker
      "nodes",   // No companion app nodes
    ],
    
    // Elevated mode disabled (container is the boundary)
    elevated: {
      enabled: false,
    },
    
    // Exec tool configuration
    exec: {
      notifyOnExit: true,
      pathPrepend: ["/home/seth/.local/bin"],
    },
    
    // Web tools (search + fetch)
    web: {
      search: {
        enabled: true,
        maxResults: 10,
      },
      fetch: {
        enabled: true,
        maxChars: 50000,
      },
    },
    
    // Sub-agent tool policy (what sub-agents can use)
    subagents: {
      tools: {
        deny: ["gateway", "cron"],  // Sub-agents can't restart gateway or schedule
      },
    },
  },

  // =========================================================================
  // Cron Jobs (Scheduled Tasks & Reminders)
  // =========================================================================
  cron: {
    enabled: true,
    maxConcurrentRuns: 2,
  },
  // NOTE: OpenClaw 2026.2.1 does NOT support defaultWakeMode / defaultSessionTarget.
  // When creating reminders, ask Seth to use "immediate" wake mode and "last" session
  // so notifications arrive on Telegram. See data/workspace/REMINDERS.md for details.

  // =========================================================================
  // Heartbeat (Proactive Agent Check-ins)
  // =========================================================================
  heartbeat: {
    enabled: false,  // Enable for proactive periodic check-ins
    // When enabled, Seth will periodically check in even without messages
    
    // intervalMinutes: 30,  // How often to check in
    // tasks: ["check reminders", "review pending items"],
    
    // NOTE: Heartbeat is NOT required for cron jobs!
    // Cron jobs with wakeMode: "immediate" will notify instantly.
    // Heartbeat is only for proactive check-ins and "next-heartbeat" cron jobs.
  },

  // =========================================================================
  // Memory (Persistent Knowledge)
  // =========================================================================
  memory: {
    enabled: true,
    // Search results limit
    searchLimit: 20,
  },

  // =========================================================================
  // Messages Configuration
  // =========================================================================
  messages: {
    responsePrefix: "[Seth]",
    ackReaction: "ü§ñ",
    queue: {
      mode: "collect",
      debounceMs: 1000,
      cap: 20,
    },
    // Group chat settings
    groupChat: {
      mentionPatterns: ["@seth", "@Seth"],
    },
  },

  // =========================================================================
  // Logging Configuration
  // =========================================================================
  logging: {
    level: "info",
    consoleStyle: "pretty",
    redactSensitive: "tools",
  },

  // =========================================================================
  // Session Configuration
  // =========================================================================
  session: {
    pruning: {
      enabled: true,
      maxAgeDays: 30,
    },
  },

  // =========================================================================
  // Commands (Slash Commands)
  // =========================================================================
  commands: {
    // Allow gateway restart via /restart command
    restart: false,  // Keep false for security
  },

  // =========================================================================
  // Messaging Channels
  // =========================================================================
  channels: {
    // Telegram Bot Integration
    // Set TELEGRAM_BOT_TOKEN in environment to enable
    // Create bot via @BotFather on Telegram
    telegram: {
      enabled: false,  // Set to true when TELEGRAM_BOT_TOKEN is configured
      // botToken: injected from TELEGRAM_BOT_TOKEN env var
      
      // Restrict access to specific Telegram user IDs (optional)
      // Leave empty to allow all users
      // Get your ID by messaging @userinfobot on Telegram
      allowedUsers: [],  // e.g., ["123456789", "987654321"]
      
      // Use polling (simpler) or webhook (more efficient for high traffic)
      polling: {
        enabled: true,
        interval: 1000,  // ms between polls
      },
      webhook: {
        enabled: false,
        // url: "https://your-domain.com/webhook/telegram",
        // secret: "your-webhook-secret",
      },
    },
    
    // Future channels (Phase 2+)
    // discord: { enabled: false },
    // slack: { enabled: false },
    // whatsapp: { enabled: false },
  },
}
